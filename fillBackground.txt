if (msg.type === 'merge') {
      let layers: SceneNode[] = clone_layer(figma.currentPage.selection)
      if (layers.length < 2) {
        figma.ui.postMessage({ type: 'not-selected' }, { origin: "*" })
      }
      else {
        for (let i = 0; i < layers.length - 1; i++) {
          if (parseInt(layers[i].name) > parseInt(layers[i++].name) && layers[i].type === 'COMPONENT' && layers[i++].type === 'COMPONENT')
          //proverqvame koe e po golemiq sloi (po golemiq se maha) i dali i 2te izbrani sa component (demek tova koeto polzvam za sloi)
          {
            let kids: SceneNode[] = clone_layer((layers[i] as ComponentNode).children) as Mutable<SceneNode>[];
            for (let j = 0; j < kids.length; j++) {
              (layers[i++] as ComponentNode).appendChild(kids[j])
            }
            //prisuedinqvame decatana po-golemiq sloi v malkiq sloi
            figma.flatten((layers[i++] as ComponentNode).children)
            layers[i].remove //mahame po golemiq sloi, 4iito deca ve4e trqbwa da sa w drugiq sloi
            figma.currentPage.selection = layers
          }
          else {
            //su6toto no ako i++ e po golqmo
            let kids: SceneNode[] = clone_layer((layers[i++] as ComponentNode).children) as Mutable<SceneNode>[];
            for (let j = 0; j < kids.length; j++) {
              (layers[i] as ComponentNode).appendChild(kids[j])
            }
            figma.flatten((layers[i] as ComponentNode).children)
            layers[i++].remove
            figma.currentPage.selection = layers
          }
        }
      }
    }